<!DOCTYPE html>
<html lang="ko">

<Head>
    <!-- 메타 데이터 작성 -->
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">

    <!-- CSS 스타일 코드 작성-->
    <style>
        /* 배경사진 삽입 (나중에 수정 )
        body {
            background-image: url('https://www.kw.ac.kr/KWData/webeditor/2020/2020_05_29_102245.jpg');
            background-size: cover;
            background-position: right;
            background-attachment: fixed;
            MARGIN: 0;
        }
        */

        #toggleButton {
            font-size: 16px;
            padding: 10px 20px;
            background-color: #3498db;
            color: #fff;
            border-radius: 5px;
            cursor: pointer;
        }

        #muk-list h4 {
            font-size: 25px;
        }


        .navbar {
            font-size: 45px;
            font-weight: bold;
        }

        .restaurant-box {
            border: 3px solid #ccc;
            padding: 10px;
            margin-bottom: 10px;
            max-width: 400px;
        }

        .data-box {
            margin-top: 10px;
        }

    </style>

</Head>

<body>
    <nav class="navbar">
        <div>
            광운대학교 먹리스트
        </div>

        <!-- 페이지 전환 버튼 -->
        <button id="toggleButton">페이지 전환</button>

        <button id="dSortA_Button">거리순↑</button>
        <button id="dSortD_Button">거리순↓</button>
        <button id="pSortA_Button">가격순↑</button>
        <button id="pSortD_Button">가격순↓</button>

        <button id="tagKR_Button">한식만 표시</button>
        <button id="tagJP_Button">일식만 표시</button>
        <button id="tagCN_Button">중식만 표시</button>
        <button id="tagWS_Button">양식만 표시</button>
    </nav>

    <div id="listPage" class="d-flex">
        <div class="flex-grow-1 rounded-2 me-1 p-2 w-50">
            <h3>목록</h3>
            <div id="muklist">

            </div>
        </div>
    </div>

    <div id="roulettePage" class="d-flex" style="display: none;">
        <div class="flex-grow-1 rounded-2 me-1 p-2 w-50">
            <h3>뽑기</h3>
            <!-- 컨텐츠 추가 필요 -->
        </div>
    </div>

    <!-- <div id="menuButtons" class="d-flex" style="display: none;">
        <div class="flex-grow-1 rounded-2 me-1 p-2 w-50">
            <h3>메뉴 선택</h3>
            <div class="menu-buttons">
                <button type="button" class="btn btn-primary" onclick="showSortedRestaurantsByMenu('한식')">한식</button>
                <button type="button" class="btn btn-primary" onclick="showSortedRestaurantsByMenu('일식')">일식</button>
                <button type="button" class="btn btn-primary" onclick="showSortedRestaurantsByMenu('중식')">중식</button>
            </div>
        </div>
    </div> -->

    <script>
        // load 핸들러
        window.addEventListener("load", () => {
            fetch("/data", {method: "POST"})
            .then((res) => res.json())
            .then((data) => {
                console.log(data);
                data.forEach(d => {
                    addToList(d);
                });
            });
        });

        // 거리순 정렬 버튼 핸들러 (오름차순)
        const dSortA_Button = document.getElementById("dSortA_Button");
        dSortA_Button.addEventListener("click", () => {
            fetch("/dSortA", {method: "POST"})
            .then((res) => res.json())
            .then((data) => {
                // console.log(data);
                const list = document.querySelector("#muklist");
                list.innerHTML ="";
                data.forEach(d => {
                    addToList(d);
                });
            })
        });

        // 거리순 정렬 버튼 핸들러 (내림차순)
        const dSortD_Button = document.getElementById("dSortD_Button");
        dSortD_Button.addEventListener("click", () => {
            fetch("/dSortD", {method: "POST"})
            .then((res) => res.json())
            .then((data) => {
                const list = document.querySelector("#muklist");
                list.innerHTML ="";
                data.forEach(d => {
                    addToList(d);
                });
            })
        });

        // 가격순 정렬 버튼 핸들러 (오름차순)
        const pSortA_Button = document.getElementById("pSortA_Button");
        pSortA_Button.addEventListener("click", () => {
            fetch("/pSortA", {method: "POST"})
            .then((res) => res.json())
            .then((data) => {
                const list = document.querySelector("#muklist");
                list.innerHTML ="";
                data.forEach(d => {
                    addToList(d);
                });
            })
        });

        // 가격순 정렬 버튼 핸들러 (내림차순)
        const pSortD_Button = document.getElementById("pSortD_Button");
        pSortD_Button.addEventListener("click", () => {
            fetch("/pSortD", {method: "POST"})
            .then((res) => res.json())
            .then((data) => {
                const list = document.querySelector("#muklist");
                list.innerHTML = "";
                data.forEach(d => {
                    addToList(d);
                });
            })
        });

        // 메뉴별 분류 버튼 핸들러 (한식)
        const tagKR_Button = document.getElementById("tagKR_Button");
        tagKR_Button.addEventListener("click", () => {
            fetch("/tagKR", {method: "POST"})
            .then((res) => res.json())
            .then((data) => {
                const list = document.querySelector("#muklist");
                list.innerHTML = "";
                data.forEach(d => {
                    addToList(d);
                });
            })
        });

        // 메뉴별 분류 버튼 핸들러 (일식)
        const tagJP_Button = document.getElementById("tagJP_Button");
        tagJP_Button.addEventListener("click", () => {
            fetch("/tagJP", {method: "POST"})
            .then((res) => res.json())
            .then((data) => {
                const list = document.querySelector("#muklist");
                list.innerHTML = "";
                data.forEach(d => {
                    addToList(d);
                });
            })
        });

        // 메뉴별 분류 버튼 핸들러 (중식)
        const tagCN_Button = document.getElementById("tagCN_Button");
        tagCN_Button.addEventListener("click", () => {
            fetch("/tagCN", {method: "POST"})
            .then((res) => res.json())
            .then((data) => {
                const list = document.querySelector("#muklist");
                list.innerHTML = "";
                data.forEach(d => {
                    addToList(d);
                });
            })
        });

        // 메뉴별 분류 버튼 핸들러 (양식)
        const tagWS_Button = document.getElementById("tagWS_Button");
        tagWS_Button.addEventListener("click", () => {
            fetch("/tagWS", {method: "POST"})
            .then((res) => res.json())
            .then((data) => {
                const list = document.querySelector("#muklist");
                list.innerHTML = "";
                data.forEach(d => {
                    addToList(d);
                });
            })
        });

        // muklist에 데이터 추가
        function addToList(restaurant) {
            let div = document.createElement("div");
            div.classList.add("restaurant-box");

            // restaurant의 각 데이터 키를 읽고 구를 만들어 삽입
            let nameElem = document.createElement("h3");
            nameElem.textContent = restaurant.name;
            div.appendChild(nameElem);

            let locationElem = document.createElement("data-box");
            locationElem.textContent = restaurant.location;
            div.appendChild(locationElem);

            let distanceElem = document.createElement("data-box");
            distanceElem.textContent = restaurant.distance;
            div.appendChild(distanceElem);

            let genreElem = document.createElement("data-box");
            genreElem.textContent = restaurant.genre;
            div.appendChild(genreElem);

            let foodTypeElem = document.createElement("data-box");
            foodTypeElem.textContent = restaurant.foodType;
            div.appendChild(foodTypeElem);

            let priceElem = document.createElement("data-box");
            priceElem.textContent = restaurant.price;
            div.appendChild(priceElem);

            let costPerformanceElem = document.createElement("data-box");
            costPerformanceElem.textContent = restaurant.costPerformance;
            div.appendChild(costPerformanceElem);

            // data.txt에서 해당 restaurant의 데이터에 따라 태그 삽입 필요
            let list = document.querySelector("#muklist")
            list.appendChild(div);
        }    

        // 리스트-룰렛 페이지 전환 버튼 
        const toggleButton = document.getElementById("toggleButton");
        toggleButton.addEventListener("click", togglePages);

        // 리스트-룰렛 페이지 전환 버튼 핸들러
        function togglePages() {
            // document item 로딩
            const listPage = document.getElementById("listPage");
            const sortedListPage = document.getElementById("sortedListPage");
            const roulettePage = document.getElementById("roulettePage");
            const dSortButtonA = document.getElementById("dSortButtonA");
            const dSortButtonD = document.getElementById("dSortButtonD");
            const pSortButtonA = document.getElementById("pSortButtonA");
            const pSortButtonD = document.getElementById("pSortButtonD");
            const tagButtonKR = document.getElementById("tagButtonKR");
            const tagButtonJP = document.getElementById("tagButtonJP");
            const tagButtonCN = document.getElementById("tagButtonCN");

            // 리스트-룰렛 토글
            if (listPage.style.display === "none") {
                // 리스트 페이지로 변경
                listPage.style.display = "flex";
                roulettePage.style.display = "none";
                dSortButtonA.style.display = "flex";
                dSortButtonD.style.display = "flex";
                pSortButtonA.style.display = "flex";
                pSortButtonD.style.display = "flex";
                tagButtonKR.style.display = "flex";
                tagButtonJP.style.display = "flex";
                tagButtonCN.style.display = "flex";
            } else {
                // 룰렛 페이지로 변경
                listPage.style.display = "none";
                roulettePage.style.display = "flex";
                dSortButtonA.style.display = "none";
                dSortButtonD.style.display = "none";
                pSortButtonA.style.display = "none";
                pSortButtonD.style.display = "none";
                tagButtonKR.style.display = "none";
                tagButtonJP.style.display = "none";
                tagButtonCN.style.display = "none";
            }
        }

    </script>
</body>